---
date: "2026-01-04"
draft: false
title: "When Money Dies: The Dynamics of Speculative Hyperinflations"
toc: true
math: true
weight:
categories:
    - 论文解析
tags:
    - 结构方程估计
    - 动态优化
    - 这是篇好文章
---

<!--more-->

# 论文数理模型完全掌握

## 1. 基础模型：STW 框架下的不可分货币 (Indivisible Money)

这是论文的第一部分（Section I），基于 Shi (1995) 和 Trejos-Wright (1995) 的连续时间版本。

### 1.1 环境设定 (Environment)

-   **时间**：连续时间 $t \in [0, \infty)$。
-   **代理人**：单位测度，分为 $N \ge 3$ 种类型（为了产生通过货币交易的需求）。
-   **偏好**：
    -   消费效用 $u(y)$，其中 $u'>0, u''<0$。
    -   生产负效用 $c(y) = y$（线性）。
    -   时间折现率 $\rho$。
-   **匹配**：泊松到达率 $\alpha$。
    -   双重需求巧合概率为 0。
    -   单重需求巧合概率 $\sigma = 1/N$（一方想要对方的产品）。
-   **货币**：总量 $M \in (0,1)$，不可分（indivisible），每人最多持有一单位（持有量 $m \in \{0, 1\}$）。

### 1.2 资产价值方程 (HJB Equations)

这是理解模型的起点。我们需要定义两个价值函数：

-   $V_{1,t}$：持有货币（买家）的期望折现效用。
-   $V_{0,t}$：未持有货币（卖家）的期望折现效用。

**推导 HJB 方程：** 在连续时间下，资产价值等于流式收益（Flow payoff）加上价值变动（Capital gain/loss）。

对于持有货币者（买家）：

$$\rho V_{1,t} = \underbrace{\alpha \sigma (1-M)}_{\text{遇到卖家的速率}} \underbrace{[u(y_t) + V_{0,t} - V_{1,t}]}_{\text{交易后的净收益}} + \underbrace{\dot{V}_{1,t}}_{\text{价值随时间的变化}} \quad (1)$$

-   解释：买家以速率 $\alpha$ 遇到人，概率 $\sigma$ 喜欢对方产品，对方必须没有货币（概率 $1-M$）才能交易。交易后，买家获得 $u(y_t)$，失去货币（价值变为 $V_{0,t}$），放弃原状态 $V_{1,t}$。

对于未持有货币者（卖家）：

$$\rho V_{0,t} = \underbrace{\alpha \sigma M}_{\text{遇到买家的速率}} \underbrace{[-y_t + V_{1,t} - V_{0,t}]}_{\text{交易后的净收益}} + \underbrace{\dot{V}_{0,t}}_{\text{价值随时间的变化}} \quad (2)$$

-   解释：卖家生产 $y_t$ 成本，获得货币变成 $V_{1,t}$。

### 1.3 议价与交易量 (Terms of Trade)

假设买家进行“全有或全无”（Take-it-or-leave-it, TIOLI）出价。买家会压榨卖家的剩余，直到卖家无差异：

$$-y_t + V_{1,t} - V_{0,t} = 0 \implies y_t = V_{1,t} - V_{0,t} \quad (3)$$

这意味着货币的价值（购买力）$y_t$ 正好等于持有货币带来的这种“价值差”。

### 1.4 结构方程与动态系统 (Structural Equation Estimation)

这是论文的核心推导部分。我们需要找到 $y_t$ 的微分方程。

**步骤 1：利用 (1) 和 (2) 消除** $V$**。** 计算 $\rho(V_{1,t} - V_{0,t})$：

$$\rho(V_{1,t} - V_{0,t}) = \alpha\sigma(1-M)[u(y_t) - (V_{1,t}-V_{0,t})] - \alpha\sigma M [-(V_{1,t}-V_{0,t}) + (V_{1,t}-V_{0,t})] + (\dot{V}_{1,t} - \dot{V}_{0,t})$$

**步骤 2：代入** $y_t = V_{1,t} - V_{0,t}$ **和** $\dot{y}_t = \dot{V}_{1,t} - \dot{V}_{0,t}$**。** 注意卖家议价公式 (3) 意味着卖家剩余为 0，所以 (2) 式简化相关项。整理得到：

$$\dot{y}_t = [\rho + \alpha \sigma (1-M)] y_t - \alpha \sigma (1-M) u(y_t) \quad (4)$$

**结构分析：** 这是一个**自治的一阶常微分方程 (Autonomous ODE)**。 定义货币流通速度参数 $\vartheta = \alpha \sigma (1-M)$。

$$\dot{y}_t = (\rho + \vartheta) y_t - \vartheta u(y_t)$$

假设 CRRA 偏好 $u(y) = y^{1-\eta}$，方程变为**伯努利方程 (Bernoulli Equation)**：

$$\dot{y}_t = (\rho + \vartheta) y_t - \vartheta y_t^{1-\eta}$$

### 1.5 求解与投机性恶性通胀

这是一个非线性方程，但可以通过变量代换线性化。 令 $x_t = y_t^{\eta}$，则 $\dot{x}_t = \eta y_t^{\eta-1} \dot{y}_t$。 代入整理得线性 ODE：

$$\dot{x}_t = \eta(\rho + \vartheta) x_t - \eta \vartheta$$

**通解：**

$$x_t = (x_0 - x^s) e^{\eta(\rho+\vartheta)t} + x^s$$

其中稳态 $x^s = \frac{\vartheta}{\rho+\vartheta}$。

**关键结论：货币何时消亡？** 如果初始值 $x_0 < x^s$（即 $y_0 < y^s$），解会发散向 0。 货币完全失去价值的时间 $T$ 是由 $x_T = 0$ 定义的。

$$T = \frac{\ln[1 - (y_0/y^s)^\eta]^{-\frac{1}{\eta}}}{\rho + \vartheta} < \infty$$

**博士级洞察：** 通常在离散时间模型中，如果 $T$ 时刻货币价值为 0，逆向归纳法会导致 $T-1$ 时刻价值也为 0。但在连续时间中，这涉及到一个奇点。Rocheteau 证明了在 CRRA 偏好下，只要流动性回报随实际余额减少而趋于无穷大（Inada 条件不满足或特定形式），有限时间的恶性通胀路径是存在的。

## 2. 扩展模型：可整除货币 (Divisible Money)

为了讨论货币增长率 $\pi_t$ 的影响，论文在 Section II 扩展到了 Lagos-Wright 类型的模型（在此为连续时间版本，类似 Choi & Rocheteau, 2021）。

### 2.1 结构方程组

**买家的 HJB 方程：**

$$\rho V_t^b(m) = \max_{c} \{ u(c) + \dots \} + \frac{1}{dt} E[dV]$$

简化后，买家持有的实际余额 $m_t$ 的边际价值由以下欧拉方程决定（论文公式 21）：

$$\rho + \pi_t - \frac{\dot{m}_t}{m_t} = \alpha \sigma L(m_t)$$

-   左边：持有货币的机会成本（名义利率 $i_t = r + \pi_t$，其中 $r$ 包含 $\dot{m}/m$ 项）。
-   右边：流动性溢价（Liquidity Premium）。$L(m)$ 衡量了放宽流动性约束带来的边际效用增益。
-   形式：$L(m) = \frac{u'(y(m))}{p'(y(m))} - 1$。

### 2.2 结构估计与校准视角

如果你想做“结构方程估计”，在宏观理论中通常指：

1. **设定函数形式**：论文设定流动性溢价函数 $L(m) = m^{-\eta} - 1$（这对应特定的 CRRA 偏好）。

2. **动态系统求解**：

    $$\dot{m}_t = (\rho + \pi_t + \alpha \sigma) m_t - \alpha \sigma m_t^{1-\eta}$$

    这又是一个伯努利方程！

3. **解析解 (Proposition 3)**： 利用积分因子法，可以求得 $m_t$ 的显式解：

    $$m_t = \left[ (\bar{m}_t)^\eta - e^{\eta [(\alpha \sigma + \rho)t + \Pi(t)]} C \right]^{1/\eta}$$

    其中 $\bar{m}_t$ 是基本面解（Monetarist solution），后一项是投机性泡沫（Speculative bubble）。

### 2.3 关键参数分析

作为博士生，你需要关注以下参数对“货币寿命” $T$ 的影响：

-   $\pi$ **(货币增长率)**：$\pi$ 越高，分母中的折现效应越大，货币死得越快。
-   $\eta$ **(风险规避/需求弹性)**：决定了当 $m \to 0$ 时，流动性溢价 $L(m)$ 趋于无穷大的速度。这是货币能否在有限时间内死亡的必要条件（需 $\eta \in (0,1)$ 或特定条件）。
-   $\alpha \sigma$ **(交易摩擦)**：摩擦越小（$\alpha$ 越大），人们越容易交易，但在恶性通胀路径中，高流速反而可能加速货币价值的崩溃（这是一个反直觉的有趣结论，见 Figure 2）。

## 3. 总结：如何掌握这篇论文

要充分掌握这篇论文的数理模型，你需要能够独立完成以下步骤：

1. **复现 ODE**：不看论文，从 HJB 方程 (1) 和 (2) 推导出 ODE (4)。
2. **求解 Bernoulli 方程**：熟练掌握 $x = y^{1-n}$ 的变量代换技巧。
3. **理解奇点**：思考为什么在 $y \to 0$ 时，微分方程的解可以触达 0 而不是渐近趋向于 0（这取决于 $u'(0)$ 的性质）。
4. **财政主导 (Fiscal Dominance)**：阅读 Section IV，尝试推导当货币增长率 $\pi_t$ 内生于政府预算约束 $g = \pi_t m_t$ 时，系统如何变成 Riccati 方程。

## 小白也能懂

# Rocheteau (2025) 结构参数校准与估计实战指南

**——从“参数空间”到“数据空间”的完全映射**

## 前言：我们要解决什么问题？

作为博士生，你拿到一个理论模型（比如 Rocheteau 的微分方程），想用它来分析现实世界（比如津巴布韦的恶性通胀）。你会发现模型里全是希腊字母（$\rho, \alpha, \sigma, \eta$），但你手头只有 Excel 表格里的数据（GDP, CPI, M1）。

本指南的任务就是教你**如何用 Excel 里的数据，算出一个个具体的希腊字母数值**，然后把它们塞回微分方程里，画出漂亮的仿真图。

## 第一步：参数大盘点（你要估计谁？）

在 Rocheteau (2025) 的模型中，决定货币“死期”（$T$）的核心公式是：

$$T = \frac{\ln[1 - (y_0/y^s)^\eta]^{-\frac{1}{\eta}}}{\rho + \alpha \sigma}$$

我们需要确定的参数如下表所示：

| 参数 | 符号 | 含义 | 来源类型 | 处理方式（小白必看） |
| --- | --- | --- | --- | --- |
| **时间折现率** | $\rho$ | 人们有多不耐烦 | **外部设定 (Fixed)** | **不估计**。通常直接设为年化 4% ($0.04$)。这是宏观经济学的行规，代表长期无风险实际利率。 |
| **货币增长率** | $\pi$ | 印钞机开得有多快 | **直接观测 (Data)** | **不估计**。直接看数据。比如你想模拟津巴布韦 2008 年，就用当时的数据（比如每月增长几亿倍）。 |
| **风险规避系数** | $\eta$ | 货币需求对利率多敏感 | **结构参数 (Unknown)** | **需要估计！** 这是效用函数 $u(c) = \frac{c^{1-\eta}}{1-\eta}$ 的曲率。 |
| **交易摩擦** | $\alpha\sigma$ | 交易有多难/多频繁 | **结构参数 (Unknown)** | **需要估计！** $\alpha$ 是遇到人的概率，$\sigma$ 是能做生意的概率。 |

**结论**：你的任务就是利用数据，把 $\eta$ 和 $\alpha\sigma$ 这两个“黑箱”解出来。

## 第二步：建立桥梁——货币需求函数

我们不能凭空猜这两个参数，必须找到一个能把模型和数据联系起来的方程。这个方程就是**货币需求函数（Money Demand Function）**。

### 1. 理论端的方程

在模型的稳态（非恶性通胀时期），欧拉方程（FOC）告诉我们名义利率 $i$ 等于流动性溢价：

$$i = \underbrace{\alpha \sigma}_{\text{摩擦}} \times \underbrace{[(\frac{M}{P})^{-\eta} - 1]}_{\text{边际效用增益}}$$

_注：这里假设了_ $u(q) = \frac{q^{1-\eta}}{1-\eta}$ _和线性生产成本_ $c(q)=q$_。_

### 2. 变形为可估计的形式

我们需要把上述方程反过来写，把“货币量”放在左边，因为我们要拟合的是“大家手里愿意拿多少钱”。

令真实货币余额 $L = \frac{M}{P}$（在宏观数据中通常对应 $M/PY$，即货币流通速度的倒数）。

通过简单的代数变换：

$$\frac{i}{\alpha \sigma} = L^{-\eta} - 1 \\ L^{-\eta} = 1 + \frac{i}{\alpha \sigma} \\ L = (1 + \frac{i}{\alpha \sigma})^{-\frac{1}{\eta}}$$

这就是我们的**圣杯方程**：

$$\text{货币需求} (L) = \left( 1 + \frac{\text{利率 } (i)}{\text{摩擦参数 } (\alpha\sigma)} \right)^{-\frac{1}{\eta}}$$

## 第三步：数据准备（Data Space）

要跑这个回归，你需要去下载以下时间序列数据（比如美国 1900-2000 年的数据，或者你想研究的国家的稳定期数据）：

1. **名义利率 (**$i_t$**)**：
    - **用什么**：通常用短期国债收益率（如 3-Month T-Bill Rate）或商业票据利率。
    - **单位**：要转化为小数（例如 5% 写成 0.05）。
2. **货币供应量 (**$M_t$**)**：
    - **用什么**：通常用 **M1**（狭义货币），因为模型里的 Money 主要指用于交易的现金和活期存款。
3. **名义 GDP (**$P_t Y_t$**)**：
    - **用什么**：名义 GDP 数据。
4. **构建被解释变量 (**$L_t$**)**：
    - 计算 **“货币-收入比率”**：$L_t = \frac{M_t}{P_t Y_t}$。
    - 直觉：这代表了全社会持有的货币量相当于这一年生产总值的几分之几。

## 第四步：怎么估计？（结构估计实操）

这是最关键的一步。我们要用 **非线性最小二乘法 (Non-linear Least Squares, NLLS)**。

### 为什么不能用普通的 OLS？

看上面的公式：$L = (1 + \frac{i}{A})^{-1/\eta}$。 这是一个高度非线性的函数，取对数也没法变成简单的 $y = ax + b$ 形式（因为里面有加法）。所以必须用 NLLS。

### 具体操作流程（以 Stata 或 Python 为例）：

**设定回归方程：**

$$y_t = \beta_0 \cdot \left( 1 + \frac{x_t}{A} \right)^B + \epsilon_t$$

-   $y_t$ **(数据)**：你计算出的 $M_t / P_t Y_t$。
-   $x_t$ **(数据)**：名义利率 $i_t$。
-   $A$ **(待估参数)**：对应模型中的 $\alpha \sigma$。
-   $B$ **(待估参数)**：对应模型中的 $-1/\eta$。
-   $\beta_0$ **(待估参数)**：一个比例常数（Scaling factor），虽然模型里它是 1，但在处理指数数据时通常需要它来调整单位。

### 结果解读（映射回参数空间）：

假设软件跑出来的结果是：

-   $\hat{A} = 0.5$
-   $\hat{B} = -3.33$

**参数换算：**

1. **交易摩擦** $\alpha\sigma$：直接就是 $\hat{A}$。
    - $\alpha \sigma = 0.5$。这意味这你每两年（$1/0.5$）才会有一次成功的货币交易机会（在某些校准中单位可能不同，需注意时间单位）。
2. **风险规避系数** $\eta$：
    - 因为 $B = -1/\eta$，所以 $\eta = -1/B$。
    - $\eta = -1 / (-3.33) \approx 0.3$。

## 第五步：为什么选择这个方法？（博士论文里怎么吹？）

当被问到“你为什么要搞这么复杂的结构估计，而不是直接跑个 CPI 回归？”时，你要这样回答：

1. **识别深层参数 (Identification of Deep Parameters)**：
    - 普通的通胀回归只能告诉我通胀和货币的关系，那是“相关性”。
    - 结构估计帮我把观察到的货币需求曲线拆解成了**“偏好”($\eta$)** 和 **“摩擦”(**$\alpha\sigma$**)** 两部分。Rocheteau 的模型证明，这两个参数对恶性通胀的死期 $T$ 有完全不同的动态影响，必须分开识别。
2. **福利分析的基础 (Welfare Analysis)**：
    - 只有知道了 $\eta$（效用函数的形状），我们才能计算恶性通胀到底让老百姓损失了多少“效用（Utils）”，而不仅仅是损失了多少钱。
3. **反事实推演 (Counterfactuals)**：
    - 估计出的 $\alpha\sigma$ 和 $\eta$ 是结构性的，理论上不随政策改变（Lucas 批判）。因此，我们可以放心地把这些参数固定住，然后强行把货币增长率 $\pi$ 拉高到 10000%，看看模型预测的 $T$ 是多少。

## 总结：你的复现清单

1. **下载数据**：找一份稳定的（比如美国 1950-2000）$M1$，$GDP$，$Interest Rate$ 数据。
2. **洗数据**：算出 $L_t = M1 / GDP$。
3. **跑回归**：用 NLLS 拟合 $L_t = \beta (1 + i_t / A)^B$。
4. **得参数**：算出 $\eta = -1/B$, $\alpha\sigma = A$。
5. **代公式**：把 $\rho=0.04, \pi=10000\%$, 以及算出的 $\eta, \alpha\sigma$ 代入 $T$ 的公式。
6. **画图**：得出结论，“在当前摩擦水平下，如果印钞速度达到津巴布韦水平，货币将在 45 天后归零”。

这就是所谓的“结构模型与数据的映射”。祝你复现成功！
