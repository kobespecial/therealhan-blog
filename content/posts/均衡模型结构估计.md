---
date: "2026-01-02T16:36:46+08:00"
draft: false
title: "均衡模型的结构估计完整讲解"
toc: true
math: true
slug:
weight: 3
categories:
    - 结构方程模型
tags:
    - 结构方程
    - 前沿方法
---

<!--more-->

# 均衡模型的结构估计完整讲解

## 第一部分：为什么需要均衡模型？

### 1.1 部分均衡模型的局限

#### 简单需求估计的问题

在前面讨论控制函数法时，我们估计的是：

```
需求方程：Q_i = α·P_i + β·X_i + ξ_i

假设：给定成本，企业选择价格
      消费者对这个价格做出购买决定
      一切结束

这个框架的问题在于：
价格不是外生给定的！
企业的定价策略取决于对竞争环境的预期
而竞争环境本身取决于其他企业的定价
形成一个"反馈循环"
```

#### 一个具体的困境

```
观察：
苹果提价了10%，销量下降20%

问题：
这个价格弹性-2意味着什么？

可能的解释1（部分均衡）：
消费者对苹果手机的需求价格弹性是-2
苹果提价10% → 销量下跌20% → 完全是需求反应

可能的解释2（一般均衡）：
当苹果提价时，竞争对手（三星、小米）看到了机会
他们降价或提高营销投入
导致消费者大量转向竞争品牌
苹果销量暴跌，看起来好像价格弹性很大
但实际上需求曲线可能更平缓
是竞争对手的反应放大了这个效应
```

#### 为什么这很重要？

```
假设我们想进行反事实分析：
"如果苹果被拆分成两家独立公司会怎样？"

在部分均衡框架中：
我们可能低估拆分带来的竞争强度增加
因为我们没有考虑其他企业会改变其定价

在均衡框架中：
我们可以捕捉到：
1. 新企业进入市场
2. 现有企业的价格和产量反应
3. 最终的新均衡

结果：反事实分析会更准确
```

### 1.2 均衡模型的核心思想

#### 什么是均衡？

在经济学中，均衡是一个"自洽"的状态：

```
定义：
给定消费者偏好、技术、成本，
存在价格向量p*和产量向量q*，使得：

1. 消费者最优化：
   给定价格p*，消费者的购买决定q_demand

2. 企业最优化：
   给定价格p*和竞争环境，企业的最优产量q_supply

3. 市场出清：
   q_demand = q_supply = q*

在这个状态下：
没有企业想要改变价格或产量
没有消费者想要改变购买决定
一切都是"自洽"的
```

#### 为什么一般均衡很难？

```
部分均衡（这门课之前学的）：
只考虑一个市场
供给曲线：Q_s = s(P)
需求曲线：Q_d = d(P)
求解：Q_s = Q_d → P*

这是一个简单的方程组
变量数 = 3 (Q_s, Q_d, P)
方程数 = 3
→ 可以解

一般均衡（现在要学的）：
有N个产品（如苹果、三星、小米等）
有M个消费者
有K个要素（劳动、资本等）

变量数：至少几百个
方程数：来自优化和市场出清
维度灾难！

所以，必须进行"战略性简化"：
- 代表性企业而非每个企业都不同
- 代表性消费者而非追踪每个消费者
- 某些变量的对称性来减少参数数量
```

### 1.3 结构估计框架的三个层次

```
第1层：需求估计（我们之前做的）
       知道消费者对产品特征和价格的偏好
       输出：需求参数

第2层：供给端反演（供给侧的推导）
       给定市场份额，推导隐含的成本
       利用企业的一阶条件
       输出：边际成本、产品特征的价值

第3层：模拟新均衡（反事实分析）
       改变某个参数（如进行合并）
       重新求解均衡
       输出：新的价格、产量、福利

这三层逐层递进
第2层依赖第1层的结果
第3层依赖第1、2层的结果
```

---

## 第二部分：需求端模型

### 2.1 消费者选择模型

#### 离散选择框架：Logit 模型

在均衡模型中，需求通常是离散选择模型。

**基本设定：**

```
代表性消费者面对N种产品（包括outside option）
产品j给消费者的效用：

U_j = α·ln(P_j) + X_j·β + ξ_j + ε_j

其中：
- α：价格系数（一般为负）
- X_j：产品观测特征（如屏幕大小、电池容量）
- β：特征偏好
- ξ_j：不可观测特征（品牌吸引力、设计等）
- ε_j：个人特定的随机项（idiosyncratic shock）
- j=0：outside option（不购买任何产品）

如果ε_j服从Gumbel分布，
消费者选择产品j的概率：

P(choose j) = exp(δ_j) / (1 + Σ_k exp(δ_k))

其中δ_j = -α·ln(P_j) + X_j·β + ξ_j 是产品j的"吸引力"
```

#### 产品差异化的 Logit（BLP 框架）

但上面这个标准 Logit 有个问题：

```
所有产品对的交叉价格弹性相同
（由随机性的分布决定）

现实中不对！
iPhone和Galaxy的交叉弹性应该很大
（都是高端手机）

iPhone和廉价按键机的交叉弹性应该很小
（完全不同的消费者群体）

解决：引入随机系数
```

**随机系数 Logit（BLP, 1995）：**

```
消费者h对产品j的效用：

U_{hj} = α_h·ln(P_j) + X_j·β_h + ξ_j + ε_{hj}

其中α_h和β_h是消费者特定的

分布假设：
α_h ~ N(ᾱ, σ_α²)
β_h ~ N(β̄, σ_β²)

这意味着：
不同消费者对价格和特征有不同敏感度
喜欢特定特征的消费者会对具有这些特征的产品
有更强的偏好

结果：
交叉价格弹性现在取决于产品的相似性
（通过特征X_j）

iPhone和Galaxy的交叉弹性 > iPhone和按键机
因为消费者对"高端"特征的评价差异大
```

#### 市场份额的反演：BLP 逆运动

在均衡估计中，关键是把**观测到的市场份额** 反演为**潜在的产品吸引力（δ_j）**。

```
观测数据：
- 各产品的市场份额 s_j（对所有产品求和=1）
- 产品特征 X_j
- 产品价格 P_j

未知：
- ξ_j（不可观测特征）

BLP逆问题：
给定s_j、X_j、P_j，求ξ_j

解法：
如果知道参数(α, β, σ_α, σ_β)，
可以通过以下步骤反演ξ_j：

步骤1：计算产品吸引力
δ_j(α, β, σ, ξ) = -α·ln(P_j) + X_j·β + ξ_j

步骤2：对不同类型消费者求平均，得到选择概率
s_j^model(δ, σ) = ∫ P(choose j | consumer h) dh

步骤3：找ξ使得s_j^model = s_j^observed
通过迭代：
  ξ_new = ξ_old + κ(s_j^observed - s_j^model)

  (这叫做"contraction mapping")

结果：得到隐含的ξ̂_j
```

#### 为什么要进行 BLP 逆运动？

```
原因1：需求估计中的内生性

在需求方程中：
ln(s_j) = -α·ln(P_j) + X_j·β + ξ_j

如果直接OLS，会有内生性问题
（因为企业的定价考虑了ξ_j）

解决方法：
进行BLP逆运动，得到ξ̂_j
然后在供给侧利用这些ξ_j反演成本

原因2：识别产品质量

ξ_j代表了"不可观测的质量/吸引力"
通过逆运动，我们可以识别这些质量
然后分析：
- 哪些产品质量高？
- 质量如何随时间变化？
- 企业是否有质量溢价权？

原因3：准备供给侧分析

需要ξ_j来反演成本
供给侧会假设：
成本不仅依赖于产品特征X_j
还可能依赖于不可观测特征ξ_j
（例如：难以衡量的设计复杂性）
```

### 2.2 价格内生性的处理

在均衡框架中，价格是内生的（与 ξ 相关）。

**识别策略（通常的做法）：**

```
使用工具变量（IV或控制函数）

典型的工具变量：

1. "BLP工具"（Hausman工具）
   工具变量 = 其他企业的产品特征

   逻辑：
   企业j的定价取决于自己的ξ_j
   但不应该直接取决于竞争对手的X_k

   然而，竞争对手的X_k影响市场结构
   从而间接影响企业j的最优价格

   例子（手机市场）：
   对iPhone的工具变量 = 三星手机的屏幕尺寸、续航时间等
   这些影响市场结构，但与iPhone的不可观测质量无关

   数学：
   Z_j = Σ_{k≠j} X_k（所有其他产品的特征之和）

2. "成本诊断工具"
   工具变量 = 影响边际成本但不影响需求的变量

   例如（对于汽车）：
   - 海运运费（影响进口车的成本）
   - 劳动力成本（影响产地的成本）

3. 政策变量工具
   如：关税变化、汇率变化等

BLP工具的直觉：
```

```
考虑极端情况：

假设消费者只看中"屏幕尺寸"
有三个iPhone型号：大、中、小尺寸

iPhone大的定价会考虑：
1. iPhone大的成本和需求
2. iPhone中的存在（潜在竞争）
3. iPhone小的存在（潜在竞争）

所以：iPhone大的价格与
      iPhone中和小的特征相关

但这种相关性不是因为"需求冲击传染"
而是因为"最优竞争"

如果我们用iPhone中的屏幕尺寸作为工具变量
来估计iPhone大的需求，是可以的！
```

---

## 第三部分：供给端模型

### 3.1 企业的最优定价决策

#### 古诺竞争框架

在大多数产业组织的均衡模型中，使用的是古诺（产量竞争）模型。

```
假设：企业选择产量q_j，而非价格P_j

市场清出时的价格由反需求曲线决定：
P(Q) = P(Σ_j q_j)

企业j的利润最大化问题：
max_{q_j} π_j = P(Q)·q_j - C_j(q_j)

一阶条件（FOC）：
∂π_j/∂q_j = P + q_j·∂P/∂Q - MC_j(q_j) = 0

重新排列：
P - MC_j = -q_j / (dQ/dP) × (∂P/∂Q)^{-1}
        = -q_j / ε_D

其中ε_D是需求的价格弹性

经济学解释：
P - MC_j = 企业j的"加成率"（Markup）
        = 产量 × 边际成本降低
        / 需求曲线的斜率
```

#### Bertrand（价格竞争）模型

在某些情况下，特别是产品差异化较大的市场，使用Bertrand（价格竞争）。

```
企业选择价格P_j，消费者根据价格选择产品

企业j的利润：
π_j = [P_j - MC_j]·Q_j(P)

其中Q_j(P)是给定价格向量P时的需求量

一阶条件：
∂π_j/∂P_j = Q_j + [P_j - MC_j]·∂Q_j/∂P_j = 0

整理：
P_j - MC_j = -Q_j / (∂Q_j/∂P_j)

这可以写成：
P_j - MC_j = Q_j / (ε_{jj})

其中ε_{jj} = (∂Q_j/∂P_j)·(P_j/Q_j) 是自身价格弹性（负数）

加成率 = -Q_j / ε_{jj}
       （由于ε_{jj}<0，这是正数）
```

#### Cournot vs Bertrand

```
什么时候用哪一个？

Cournot（产量选择）：
✓ 适合齐质产品市场（如原油、玉米）
✓ 容易计算均衡
✓ 更符合某些行业的实际竞争方式
✗ 价格竞争不够直接

Bertrand（价格选择）：
✓ 更符合现实（企业确实设定价格）
✓ 产品差异化时更自然
✓ 更方便与需求直接挂钩
✗ 均衡计算可能复杂

在产业组织应用中：
- 消费产品（手机、汽车、食品）→ Bertrand
- 原料商品（钢铁、能源）→ Cournot
- 无菌的产品（如药品）→ 两者都用，结果敏感性分析

关键洞察：
在很多情况下，两种模型给出相似的结果
（至少对"质量"问题）
因为：价格或产量的选择都取决于
      生产率、成本、需求弹性等根本因素
```

### 3.2 从市场数据反演成本

#### 基本思路

在已知需求参数后，供给端的目标是反演**边际成本（MC）**。

```
已知：
- 观测的产品价格P_j
- 估计得到的市场份额s_j和产量Q_j
- 需求参数α、β等

未知：
- 边际成本MC_j
- 以及隐含的产品质量ξ_j

关键方程（一阶条件）：
对于Bertrand竞争：
  P_j - MC_j = -s_j / (ε_{jj})

  → MC_j = P_j + s_j / ε_{jj}

其中ε_{jj} = (∂ln(Q_j)/∂ln(P_j))·(P_j)
             = -α + 某个取决于竞争的项

从这个方程，我们可以反演MC_j！
```

#### 具体的反演步骤

```
步骤1：计算价格弹性

在Logit框架中：
∂ln(Q_j)/∂ln(P_j) = α + (某个交叉项取决于替代结构)

例如，在标准Logit中：
ε_{jj} = α + Σ_k s_k·α = α·(1 - s_j)

这反映了两个效应：
- 直接效应：价格上升，选择该产品的消费者减少（αs_j）
- 间接效应：价格上升，转向其他产品的消费者增加

步骤2：用一阶条件计算MC

从Bertrand FOC：
P_j - MC_j = -s_j / ε_{jj}

代入：
MC_j = P_j - s_j / ε_{jj}
     = P_j - s_j / [α·(1-s_j)]
     = P_j + s_j / [α·(s_j - 1)]

（注意α是负数，所以这是减法）

步骤3：检验合理性

验证：
- MC_j > 0（成本应该为正）
- MC_j < P_j（边际成本应该小于价格）
- MC_j的符号模式有经济学意义
  （是否高成本产品定价更高？）
```

#### MC 反演的直觉

```
为什么这个方法有效？

核心：企业的一阶条件

给定需求函数，企业为了最大化利润，
选择特定的价格。
这个价格隐含地反映了企业的成本。

反演过程就是：
从价格"读出"成本信息

类比：
如果你看到一个企业以100元的价格销售产品，
且该产品的市场份额为5%，
需求曲线很陡（α很负），

那么这个企业一定有相对较低的成本
（否则，给定这样的市场份额和需求曲线，
不会定价这么高）

反之，如果另一个企业定价50元但市场份额也是5%，
那么这个企业的成本一定更低
（因为定价更低但市场份额相同，
说明需求曲线或竞争结构不同）
```

### 3.3 产品属性的边际价值

在某些应用中，我们不仅想反演总成本，还想反演**产品特征的成本**。

```
模型设定：
成本函数：C_j(q_j) = f(X_j, ξ_j, q_j; Θ_cost)

其中：
- X_j：可观测特征（屏幕尺寸、续航、处理器等）
- ξ_j：不可观测质量
- Θ_cost：成本参数（待估计）

包含：
比如：
C_j = α₀ + α_X·X_j + α_ξ·ξ_j + α_q·q_j + α_q²·q_j²

含义：
- α_X：增加某个特征会增加多少成本
- α_ξ：难以衡量的质量提升会增加多少成本
- α_q：规模经济的存在程度

估计步骤：

步骤1：从市场数据反演MC_j（如上所述）

步骤2：计算边际成本与特征的关系

如果成本函数正确指定，
那么：dC_j/dX_j 应该与MC_j和X_j相关

建立回归：
MC_j = α₀ + α_X·X_j + α_ξ·ξ_j + ω_j

用GMM估计，其中：
- Z = [其他企业的X, 成本工具变量]
- ω_j 是测量误差

步骤3：获得参数估计

结果给出每个特征的隐含成本
```

---

## 第四部分：均衡的存在与求解

### 4.1 均衡的存在

#### 什么时候均衡存在？

```
对于古诺竞争：
存在充分条件通常比较温和

反需求曲线：P(Q) = a - b·Q（线性）
成本函数：C_j(q_j) = c_j·q_j（线性MC）

则均衡存在且唯一！

对于Bertrand竞争：
情况更复杂，特别是当产品差异化度有限时

例如，在标准Logit框架中：
总是存在均衡

但在某些产品差异化程度很高的模型中：
可能不存在纯策略均衡
需要考虑混合策略均衡
```

### 4.2 均衡的求解方法

#### 方法 1：固定点迭代（Tâtonnement）

最直观的方法：

```
初始化：
设定初始的价格向量P_0

迭代：
步骤t：
1. 给定P_t，计算每个企业的最优定价P_t+1_j
   （通过一阶条件）
2. 更新整个价格向量P_t+1
3. 检查收敛：||P_t+1 - P_t|| < ε?
   如果是 → 停止（找到均衡）
   如果否 → 返回步骤1

问题：
这个迭代可能不收敛
需要使用减速因子或其他技巧来保证收敛

优点：
简单直观
易于理解和调试
```

#### 方法 2：最小化"超额需求"

更数学的方法：

```
定义"超额需求"为：
ED_j(P) = Q_j^demand(P) - Q_j^supply(P)

在均衡时，所有市场都应该出清：
ED_j(P*) = 0 对所有j

所以，求解均衡等价于：
找到P*使得ED_j(P*) = 0

方法：
定义一个"失衡度量"函数：
F(P) = Σ_j [ED_j(P)]²

然后最小化F(P)：
如果min F(P) = 0，那就找到了均衡

用数值优化算法（如牛顿法）求解

优点：
有明确的目标函数
数值更稳定

缺点：
计算量大
高维优化可能很慢
```

#### 方法 3：利用结构性质的特殊算法

对于某些特殊结构（如线性需求+线性成本），可以直接求解。

```
假设：
需求：P = a - b·Q（其中Q = Σ_j q_j）
成本：C_j(q_j) = c_j·q_j
企业j的FOC：
  P + q_j·∂P/∂q_j = MC_j
  a - b·Q - b·q_j = c_j

这是一个线性方程组！

整理为矩阵形式：
A·Q = b

其中Q = (q_1, ..., q_N)'

可以直接用矩阵求逆：
Q* = A^{-1}·b

然后P* = a - b·Q*

优点：
很快！
计算闭形解

缺点：
只对特殊结构有效
```

### 4.3 均衡的唯一性与多重性

```
某些模型可能有多个均衡！

这会导致问题：
对于同样的数据，
可能有多个不同的参数值与数据一致

例子（寡占市场）：
三家企业的竞争模型

若参数(α, MC)满足FOC，
那么不同的(α', MC')可能也满足（如果均衡改变了）

解决方法：

1. 添加额外的识别约束
   比如：假设成本函数的特定形式
   或者：利用其他市场的数据

2. 进行敏感性分析
   考虑所有可能的均衡
   看反事实结果是否对均衡选择敏感

3. 使用"Nonce"方法
   选择一个特定的均衡（比如对称均衡）
   并明确说明

4. 利用动态模型
   多期数据可能有助于区分多重均衡
```

---

## 第五部分：反事实分析

### 5.1 基本框架

#### 什么是反事实分析？

```
定义：
给定估计得到的参数，
改变某个"政策变量"或市场结构，
重新求解均衡，
对比新均衡与原均衡的差异。

例子：
1. 并购反事实
   问：如果Microsoft和Apple合并会怎样？

   操作：
   - 合并后，这两个产品的成本可能会降低（规模经济）
   - 或者，定价策略改变（内部化竞争）
   - 重新求解均衡
   - 计算新的价格、市场份额、消费者福利

2. 产品退出反事实
   问：如果某个竞争对手退出市场怎样？

   操作：
   - 将该竞争对手的产品从模型中移除
   - 重新求解均衡（其他企业会调整价格）
   - 计算影响

3. 成本变化反事实
   问：如果生产成本下降（如技术进步）怎样？

   操作：
   - 改变成本函数参数
   - 重新求解均衡

4. 政策反事实
   问：如果征收特定关税怎样？

   操作：
   - 进口产品的成本增加
   - 重新求解均衡
   - 计算消费者和生产者的福利变化
```

#### 反事实的好处

```
为什么要做反事实？

1. 政策评估
   定量评估某项政策的可能影响
   （在实施前预测）

2. 并购审查
   预测并购对消费者福利的影响
   反垄断部门可以用这个来决定是否批准

3. 结构改革评估
   工业重组、产业升级等

4. 学术理解
   某个参数改变一点，结果如何改变？
   帮助理解模型的机制

5. 政策讨论
   量化的证据比定性讨论更有说服力
```

### 5.2 反事实分析的具体步骤

#### 第一步：选择反事实场景

```
清晰定义要改变什么：

1. 成本改变？
   是哪个产品的成本？改变多少？

   例如：
   "iPhone的边际成本从300美元降到250美元"

2. 产品数量改变？
   是进入新产品？还是退出？

   例如：
   "一个成本为200美元、质量为5的新竞争对手进入"

3. 消费者偏好改变？
   例如：
   "由于广告，消费者对某个特征的偏好系数增加10%"

4. 市场结构改变？
   例如：
   "两个企业合并，可以共享成本"

关键原则：
改变要"有原则" - 要么基于理论，
要么基于可观测的政策变化
不要随意改参数
```

#### 第二步：更新参数

```
基于反事实场景，更新相关参数：

例子1（成本改变）：
新的成本 C_j^new = C_j^old × (1 - Δ)

例子2（产品进入）：
增加一个新的产品j_new
设定其特征X_new、价格P_new（初始猜测）
设定其边际成本MC_new

例子3（合并）：
合并后：
- 产品继续存在但由同一个企业所有
- 成本可能会改变（比如共享R&D成本）
- 企业会内部化之前的竞争关系

特别处理合并：
合并后，企业的利润函数改变：
π_j + π_k → π_{j,k} = (P_j - MC_j)·Q_j + (P_k - MC_k)·Q_k

新的FOC：
∂π_{j,k}/∂P_j = 0
∂π_{j,k}/∂P_k = 0

这会导致不同的定价（通常更高，因为考虑了产品间的替代）
```

#### 第三步：求解新均衡

```
使用前面介绍的方法之一（固定点迭代、超额需求最小化等）
求解新的价格和产量。

初始化：
从现有均衡出发作为起点（warm start）
这样通常收敛更快

收敛判定：
||P_new - P_old|| < ε，比如ε = 0.01%

结果输出：
新的价格向量P_new
新的产量向量Q_new
新的市场份额向量s_new
```

#### 第四步：比较与福利分析

```
对比原均衡与新均衡：

1. 直接效果：
   - 价格如何改变？
   - 产量如何改变？
   - 企业利润如何改变？

2. 竞争效果：
   - 其他企业如何反应？
   - 市场份额如何转移？

3. 消费者福利：

   消费者剩余变化：
   ΔCS = ∫ [s_new(P) - s_old(P)] dP

   或近似为：
   ΔCS ≈ Σ_j [s_j^new - s_j^old] × (P_j^old)
          + Σ_j s_j^new × (P_j^new - P_j^old)

   第一项：由于产品可得性改变
   第二项：由于价格改变

   更准确的做法：用补偿变差（Compensating Variation）
   找到使消费者无差别的收入补偿

4. 生产者福利：

   生产者利润变化：
   Δπ_j = (P_j^new - MC_j^new)·Q_j^new
         - (P_j^old - MC_j^old)·Q_j^old

5. 总福利：

   ΔW = ΔCS + Δπ

   注意：
   需要检查是否有死重损失(deadweight loss)
```

### 5.3 反事实分析的常见形式

#### 并购反事实

```
问题：两个企业合并的影响

关键参数变化：

1. 内生产品之间的定价协调

   合并前：企业1和企业2独立定价
   P_1^old，P_2^old满足各自的FOC

   合并后：企业1-2统一考虑
   新的FOC：
   ∂(π_1 + π_2)/∂P_1 = 0
   ∂(π_1 + π_2)/∂P_2 = 0

   这会导致定价更协调（通常更高）

   经济学机制：
   企业意识到提高P_1会转移需求到P_2
   所以可以"内部化"这个转移

   对消费者不利：更高的价格
   对合并企业有利：更高的利润

2. 成本节约（如果有的话）

   合并可能带来：
   - 研发共享（降低R&D成本）
   - 供应链整合（降低采购成本）
   - 管理效率提升

   量化：新的MC_1^merge < MC_1^old（可能）

   对消费者的好处：可能通过降价转移

3. 产品退出（在某些情况下）

   如果两个产品很相似且合并后成本不下降
   企业可能停止生产其中一个

   这通常对消费者有害（选择减少）

反事实评估：
比较 ΔCS + Δπ_1 + Δπ_2 + ...
来评估总福利变化

如果ΔW > 0且ΔCS也增加，好
如果ΔW > 0但ΔCS减少，需要在效率和分配间权衡
```

#### 产品退出反事实

```
问题：某个企业或产品退出市场

机制：
1. 直接效果
   选择集变小：消费者失去了一个选项

2. 竞争效果
   其他企业失去了一个竞争对手
   可能提价（因为需求转向它们）

3. 市场份额转移
   退出产品的消费者转向其他产品
   分配根据特征相似性而定

   例子：
   iPhone退出 → 消费者转向Galaxy或Pixel
   转向比例取决于相似性参数

反事实计算：

假设原来有产品j
现在将其从模型中移除

重新求解其他产品的均衡：
max π_k = (P_k - MC_k)·Q_k(P_{-j})

其中Q_k(P_{-j})是不包含j的产品的需求

结果：
P_k通常会上升（竞争减少）
s_k会增加（市场份额转移）

消费者福利：
两个相反的效应
1. 负面：选择集变小
2. 正面：其他产品可能降价（如果成本下降）？
   通常是负面：其他产品会升价

总体：通常ΔW < 0（福利损失）
除非退出的产品质量很低或成本很高
```

#### 市场进入反事实

```
问题：新产品进入市场的影响

参数设定：

1. 进入产品的特征和成本
   X_new = [屏幕尺寸, 电池容量, 处理器, ...]
   MC_new = 进入企业的边际成本

2. 进入产品的初始价格
   通常设定为使其获得某个目标市场份额的价格
   或者设定为使利润为零的价格（零利润条件）

3. 进入后的市场动态
   固定进入产品的价格，求解其他产品的均衡
   或者：让进入产品也优化定价（更复杂）

反事实计算：

步骤1：求解包含新产品的均衡
步骤2：对比原均衡（无新产品）

效果：
1. 消费者获益：更多选择，可能降价
2. 现有企业受损：市场份额下降，可能降价
3. 进入企业的利润取决于其竞争力

应用：
评估新的竞争对手进入的影响
比如：5G技术能否帮助新的通信运营商进入？
```

---

## 第六部分：识别与估计

### 6.1 识别的挑战

#### 什么是识别问题？

在均衡模型中，识别特别困难。

```
问题的根源：

在一个单一的均衡数据点上，
多个不同的参数组合可能与数据一致！

例子：

需求：Q_j = A·P_j^α
供给（FOC）：MC_j = P_j·(1 + 1/α)

观测：P_j = 100，Q_j = 50

反演：
如果α = -2，则MC_j = 50
如果α = -3，则MC_j = 66.7
...

所以，单用价格和产量无法唯一确定α和MC_j！

在均衡模型中尤其糟：
- 需求参数α影响供给侧的FOC
- 成本参数影响均衡价格和产量
- 两者相互纠缠

结果：识别集合很大
（许多参数组合都与数据一致）
```

### 6.2 标准的识别策略

#### 策略 1：排除约束

在需求估计时使用排除约束（工具变量）：

```
假设：某些变量Z影响供给侧（成本），
       但不直接影响需求

例子（手机市场）：
Z = 进口关税

逻辑：
进口关税影响进口手机的成本（供给侧）
但消费者的偏好（需求）不会直接改变

如果Z只通过成本影响价格，
那么观察Z的变化如何影响价格
就能识别需求的价格敏感性α

关键假设：
从有效的排除约束（Z不在需求方程中）
```

#### 策略 2：假设成本函数形式

通常假设成本函数是某种特定形式：

```
例子：

假设1：常数边际成本
MC_j = c（与产量无关）

假设2：线性成本
MC_j = a + b·q_j

假设3：成本依赖于产品特征
MC_j = f(X_j) + ε_j

给定成本函数的形式，
可以从一阶条件反演出成本参数

这样就减少了要估计的参数数量
帮助识别
```

#### 策略 3：利用时间变异性

使用面板数据（多个时期）：

```
需求参数(α, β)应该在时间上相对稳定
但成本参数可能因技术进步而变化
价格和产量则会变化

利用这种差异：
用多期数据，成本可能有不同的时间模式
而需求参数应该相对稳定

通过限制需求参数的变化
可以帮助识别
```

#### 策略 4：结构假设

某些模型的特殊结构可以帮助识别：

```
例子：

假设产品是"水平差异化"的
（消费者的最优选择仅取决于品味差异）

在这种情况下，
市场份额的相等性意味着什么？
两个产品有相等的市场份额
→ 可能意味着它们质量相同？

这给出了隐含的约束
帮助识别不可观测特征
```

### 6.3 估计方法

#### 方法 1：两步估计（标准方法）

这是 BLP (1995)的经典框架：

```
第一步：估计需求参数

1a. 选择需求函数形式（通常是Logit或Nested Logit）
1b. 选择工具变量（排除约束）
1c. 使用GMM或IV估计需求参数(α, β, σ)
   （αP是价格系数，β是特征系数，σ是随机系数方差）

1d. 结果：得到α̂, β̂, σ̂

输出：估计的需求模型

第二步：反演成本参数

2a. 用估计的α̂, β̂, σ̂进行BLP逆运动
   反演不可观测特征ξ̂_j

2b. 建立成本函数模型：
    MC_j = f(X_j, ξ_j; θ_cost)

    或者更复杂的版本：
    ln(MC_j) = θ_0 + θ_X·ln(X_j) + θ_ξ·ξ_j + ...

2c. 用反演的MC和相应的变量进行回归
    估计成本参数θ_cost

输出：估计的供给模型和成本参数
```

#### 方法 2：联立估计（更高级）

一步同时估计需求和供给参数（==更好用==）：

```
建立完整的均衡模型：

需求：给定P，消费者最大化效用，导出s(P|α,β)
供给：给定α,β（从需求推导），企业最大化利润，导出P*(β,MC)

目标函数：
最小化 ||P_observed - P*(θ_demand, θ_supply)||
        + ||s_observed - s(P|θ_demand)||

通过GMM估计(θ_demand, θ_supply)

优点：
1. 更有效率（同时使用所有约束）
2. 减少估计误差传递（两步法中，第一步的误差会传递到第二步）

缺点：
1. 计算非常复杂（嵌套的优化问题）
2. 需要求解均衡作为优化的一部分
3. 收敛困难

通常用于学术研究而不是应用
```

#### 方法 3：贝叶斯估计

在面对识别困难时，有时使用贝叶斯方法：

```
好处：
1. 可以自然地纳入先验信息
2. 处理识别集合不是点而是一个区间的情况
3. 提供参数的后验分布（不仅仅是点估计）

做法：
1. 设定参数的先验分布
   比如：α ~ N(-1.5, 0.5²)
         MC ~ Lognormal(...)

2. 用贝叶斯方法更新先验
   后验 ∝ 似然 × 先验

3. 使用MCMC抽样（如Metropolis-Hastings）
   来获得后验分布的样本

4. 对样本进行推断

优点：自然处理不确定性
缺点：计算量巨大，需要编程能力强
```

---

## 第七部分：实际应用与案例

### 7.1 案例 1：手机市场的并购分析

```
背景：
假设我们要评估三星收购LG手机部门的影响

数据准备：
- 2018-2022年的销售数据（各品牌、型号）
- 产品特征：屏幕尺寸、电池容量、处理器等
- 价格数据
- 成本的代理变量（如工资、原材料价格）

第一步：估计需求参数

使用随机系数Logit模型：
U_hij = α_h·log(P_j) + X_j·β_h + ξ_j + ε_hij

其中：
- h代表消费者类型（如按购买力）
- i代表个体
-
设定随机系数：
α_h ~ N(ᾱ, σ²_α)
β_h ~ N(β̄, σ²_β)

工具变量：
BLP工具：其他品牌的屏幕尺寸、处理器规格等
成本工具：用工资、原材料成本指数

估计结果可能是：
ᾱ = -0.8（价格系数，合理的负数）
σ²_α = 0.3（消费者对价格的敏感性差异）
β_display = 0.15（屏幕大小增加喜欢度）
...

第二步：反演成本

用估计的需求参数，反演不可观测特征ξ̂

建立成本模型：
ln(MC_j) = θ_0 + θ_X·X_j + θ_ξ·ξ_j + ω_j

估计结果可能是：
屏幕大小的成本系数 = 0.15
（屏幕大10单位，成本增加15%）

不可观测特征的成本系数 = 0.2
（质量/品牌好度高的产品，成本也高）

第三步：反事实分析

场景1：直接合并（不考虑规模经济）
- 三星手机和LG手机现在由同一个企业定价
- FOC改变：企业会考虑提价三星时会失去多少LG销售
- 结果：三星和LG的价格都上升（失竞争）

场景2：考虑规模经济
- 生产成本由于共享设施而下降10%
- 这种成本节约会部分转化为降价
- 结果：价格变化不确定（取决于成本节约大小）

场景3：产品线合理化
- 假设LG停止生产低端手机
- 现在只有三星的低端产品
- 消费者被迫购买稍贵的三星产品或转向其他品牌
- 结果：消费者福利下降

比较：
计算三个场景的：
- 消费者剩余变化
- 企业利润变化
- 总福利变化

反垄断部门可能用这些来判断是否批准合并
```

### 7.2 案例 2：成本冲击分析

```
背景：
2021年芯片短缺对手机市场的影响

观察现象：
手机价格上升
销量下降
特别是高端手机受影响更大（因为芯片成本占比更大）

模型应用：

第一步：估计芯片成本增加的幅度
通过芯片价格数据反演出来：
芯片成本上升了30%

第二步：更新成本函数
ln(MC_j^2021) = ln(MC_j^2020) + 0.30·{芯片使用量_j}

其中芯片使用量与产品性能相关

第三步：重新求解均衡
给定新的成本，企业重新优化定价
由于成本上升，企业倾向于提价
但也要考虑需求的反应

第四步：对比分析
比较：
原均衡（2020）：iPhone价格999元，销量50万部
新均衡（2021）：iPhone价格1049元，销量45万部

反事实：如果2020年就知道会有芯片短缺，该怎么办？
```

### 7.3 案例 3：政策评估

```
背景：
政府考虑对进口手机征收15%的关税

问题：
会对消费者和国内企业有什么影响？

建模：

第一步：确定受影响的产品
Apple、Samsung等进口品牌的产品
国内品牌不受影响

第二步：更新成本
进口产品的成本增加15%

第三步：求解新均衡
国内品牌：由于失去竞争，可能提价
进口品牌：要么吸收关税（利润下降），要么提价

第四步：福利计算
消费者福利：下降（更高的价格）
国内企业：可能增加（竞争减少）
政府税收：增加（来自关税）

总福利：通常下降（通常没有规模经济或竞争改善）
除非国内企业因此能够技术进步
```

---

## 第八部分：常见问题与解决方案

### 8.1 计算问题

#### 问题 1：均衡不收敛

```
症状：
固定点迭代不收敛
误差越来越大，而不是减小

原因：
1. 步长太大（迭代更新幅度太大）
2. 竞争很激烈（反应函数斜率很陡）
3. 模型本身有多重均衡

解决方案：

1. 使用减速因子(Damping)
   P_{t+1} = P_t + λ·(P̃_{t+1} - P_t)
   其中λ ∈ (0,1)是减速因子
   λ = 0.5或0.3通常有效

2. 改用其他算法
   不用固定点迭代
   而用超额需求最小化
   或梯度下降

3. 检查模型规范
   参数是否合理？
   需求曲线是否太陡（α太负）？
```

#### 问题 2：多重均衡

```
症状：
从不同的初始价格出发，得到不同的均衡

这在Bertrand竞争中比较常见

解决方案：

1. 选择一个特定的均衡（比如对称均衡）
   并明确报告

2. 进行敏感性分析
   看反事实结果对均衡选择是否敏感

3. 使用"最稳定"的均衡（如果能定义的话）

4. 理论上：使用完全信息动态博弈
   多期模型通常有唯一均衡
   但计算成本很高
```

### 8.2 识别问题

#### 问题 3：参数无法识别

```
症状：
当改变某个参数时，拟合度没有变化
（或变化很小）

这意味着该参数无法从数据中识别

原因通常是：
1. 数据变异性不足
   比如，所有产品的价格都相似
   无法识别价格系数α

2. 共线性
   两个参数的影响很难区分

3. 模型规范问题
   参数根本就不出现在观测方程中

解决方案：

1. 添加排除约束
   使用工具变量来提供额外的变异性

2. 添加数据
   不同市场、不同时期的数据
   增加变异性

3. 添加外部信息
   比如，从其他研究已知某个参数的值
   然后固定它

4. 使用贝叶斯方法
   设定强先验
   提供"人为的"识别（虽然不理想）

5. 进行识别范围分析
   报告参数的可能范围而非点估计
```

#### 问题 4：排除约束不满足

```
症状：
选择的"工具变量"Z实际上与需求误差相关
（违反了排除约束）

表现：
- Sargan检验显著（拒绝H0）
- 不同的Z选择给出不同的结果
- 敏感性分析显示对工具变量选择很敏感

解决方案：

1. 再仔细想想
   这个变量真的与需求无关吗？
   可能有你没想到的通道？

2. 查找新的工具变量
   想想什么真正只影响供给侧

3. 使用弱工具变量诊断
   即使工具变量不完美，
   也可能仍然有识别能力（虽然较弱）

4. 进行稳健性分析
   使用多个工具变量
   看结果是否一致

5. 回到理论
   也许这个问题不能用这个方法解决
   需要设计其他方法
   （比如找自然实验）
```

### 8.3 模型验证

#### 问题 5：模型拟合不好

```
症状：
估计的模型不能很好地预测观测到的价格和产量

例如：
实际市场份额 = 10%
模型预测 = 20%
误差很大

可能的原因：

1. 模型设定错误
   比如，随机系数的分布形式错了
   或者遗漏了重要的产品特征

2. 参数估计有偏
   由于内生性或其他问题

3. 假设太强
   比如，消费者完全理性
   其实有心理偏差

4. 数据质量问题
   定义不匹配或测量误差

解决方案：

1. 诊断检查
   看模型在哪些地方拟合不好
   比如：高端产品或低端产品？
   是否有时间趋势？

2. 特征设定
   添加遗漏的重要特征
   比如，品牌指标变量

3. 放松假设
   比如，允许消费者异质性更强
   或使用非参数需求

4. 数据检查
   重新审视原始数据
   是否有异常值或错误编码？
```

---

## 第九部分：高级话题

### 9.1 动态模型

在某些情况下，企业的决策是动态的（跨期）：

```
企业考虑：
"今天提价会失去多少消费者？"
"这些消费者明年会不会回来？"
"我应该关注长期利润还是短期利润？"

动态模型框架：

企业的价值函数：
V_j(S_t) = π_j(P_t, S_t) + β·E[V_j(S_{t+1})]

其中：
S_t是状态变量（市场份额、消费者认知等）
β是贴现因子
E是对未来的期望

解决：
需要用动态规划解决（非常复杂）
通常用数值方法（backward induction）

结果：
企业的最优策略取决于未来的预期
比如，如果预期竞争对手明年会退出，
今年可能会降价来积累消费者

应用：
分析长期竞争动态
预测何时企业会进入或退出
理解品牌忠诚度对竞争的影响
```

### 9.2 网络与平台经济

在平台经济中（如 Uber、淘宝），模型需要修改：

```
特点：
1. 网络效应（更多供给者→更多需求者，反之亦然）
2. 双边市场（消费者和供给者都是经济参与者）
3. 平台对价格的干预（平台从两边都收费）

建模：
需求端：消费者的参加决定取决于供给者数量
供给端：供给者的参加决定取决于消费者数量

两边的参加数量形成一个"自强化循环"

均衡：
多重均衡很常见（"先发制人"问题）
"好的"均衡：两边都多，交易活跃
"坏的"均衡：两边都少，交易稀少

政策含义：
平台的首发补贴政策是必要的
来打破"坏的均衡"

应用例子：
网约车市场进入反事实
社交平台的用户增长模型
```

### 9.3 异质性与机器学习

处理大量异质性时，机器学习方法有用：

```
问题：
如果有几千种产品特征组合
很难用传统参数模型估计每一个的需求

解决：
用机器学习算法（如随机森林）
直接从数据学习产品相似性

比如：
不用假设logit或线性
而用神经网络学习: P(choose j | X) = f(X; θ_NN)

好处：
1. 更灵活，不依赖特定的函数形式
2. 可以捕捉复杂的特征相互作用

坏处：
1. 黑盒，难以解释
2. 样本外泛化困难（容易过拟合）
3. 均衡分析变得很困难

最新进展：
结合传统计量方法和ML
用ML来非参数估计，然后进行均衡分析
```

---

## 第十部分：总结与实践指南

### 10.1 何时使用均衡模型？

```
适合的情况：

1. 寡占市场（少数大企业）
   因为企业的战略行为和相互影响很重要

2. 产品差异化程度高
   企业有定价权，不是价格接受者

3. 需要进行反事实分析
   特别是涉及市场结构改变（并购、进入）

4. 关心竞争效应和福利
   需要深入理解市场机制

不适合的情况：

1. 完全竞争市场
   企业是价格接受者，模型过度复杂

2. 有很多小企业且进出频繁
   代表性企业假设太强

3. 消费者行为很复杂、非理性
   传统经济学模型不适用

4. 没有足够的数据
   识别和估计会很困难
```

### 10.2 实施检查清单

```
□ 数据准备
  ☐ 价格数据（准确且完整）
  ☐ 产量/销量数据（或市场份额）
  ☐ 产品特征数据（完整列表）
  ☐ 足够的时期（panel data更好）
  ☐ 足够多的产品（至少30+）

□ 需求模型
  ☐ 选择离散选择还是连续模型
  ☐ 选择Logit、Nested Logit、还是随机系数
  ☐ 列出所有产品特征
  ☐ 识别工具变量（排除约束）
  ☐ 进行弱工具变量诊断

□ 供给模型
  ☐ 决定使用Cournot还是Bertrand
  ☐ 指定成本函数形式
  ☐ 检查一阶条件的合理性
  ☐ 计算隐含的边际成本

□ 均衡计算
  ☐ 选择均衡求解算法
  ☐ 检查收敛
  ☐ 诊断多重均衡（如果存在）

□ 反事实分析
  ☐ 清晰定义反事实场景
  ☐ 合理设定参数变化
  ☐ 求解新均衡
  ☐ 计算福利变化
  ☐ 进行敏感性分析

□ 报告与验证
  ☐ 清楚解释模型假设
  ☐ 展示需求估计结果
  ☐ 展示反演的成本
  ☐ 对比反事实与基准
  ☐ 讨论局限和稳健性
```

### 10.3 常见陷阱

| 陷阱 | 症状 | 预防 |
| --- | --- | --- |
| **排除约束无效** | Sargan 检验显著 | 理论上仔细推敲，尝试多个工具 |
| **模型过度拟合** | 样本内拟合好，样本外差 | 交叉验证，简化模型 |
| **识别不足** | 参数的标准误很大 | 增加数据，添加外部约束 |
| **忽视多重均衡** | 反事实对初始值敏感 | 尝试多个起点，理论分析 |
| **不合理的参数** | 需求曲线太陡或太平 | 对比文献值，进行敏感性分析 |
| **忽视异质性** | 平均参数掩盖重要差异 | 进行子样本分析，随机系数 |

### 10.4 学习路径

```
初级（入门）：
1. 学习基本的产业组织理论
   古诺、Bertrand、产品差异化等

2. 理解简单的2x2案例
   2个企业，2个产品
   手工计算均衡

3. 学习基本的离散选择模型
   Logit、嵌套Logit

4. 实施简单的案例研究
   小规模数据，有现成的代码

中级（应用）：
1. 学习BLP框架
   随机系数Logit、逆运动等

2. 理解从市场份额反演成本
   及其在反事实中的应用

3. 实施真实的案例研究
   比如：简单的并购评估

4. 进行敏感性和稳健性检查

高级（研究）：
1. 扩展模型以处理特定应用
   比如：网络效应、动态性、异质性

2. 关注识别和统计推断
   参数置信区间、Bayesian方法

3. 开发新的计算方法
   加快均衡求解等

4. 进行创新的实证应用
```

---

## 最终建议

均衡模型是产业组织中最强大的工具之一，但也很复杂。

**核心要点：**

1. **从简开始** 不要试图在第一个模型中包含所有复杂性先用简单的设置验证思路

2. **诚实对待假设** 清楚陈述所有假设讨论它们的现实性

3. **充分的诊断和稳健性检查** 一个有局限但经过充分检查的模型比一个精美但无人验证的模型更可信

4. **理论和实证的结合** 理论给出直觉和指导数据给出现实检验

5. **透明和可复现** 尽可能详细地描述方法提供代码和数据（如法律允许）

6. **明确的政策含义** 不要只报告参数和拟合度说清楚这些对现实世界政策的含义

好的均衡模型分析能够： ✓ 量化竞争效应 ✓ 预测政策或市场变化的影响 ✓ 识别市场力量和效率损失 ✓ 为反垄断等政策提供依据

但也需要承认： ✗ 许多假设是简化的 ✗ 现实比模型复杂 ✗ 结果对假设敏感

平衡两者，就能进行有价值的分析。
