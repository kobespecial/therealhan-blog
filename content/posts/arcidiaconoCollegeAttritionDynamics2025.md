---
date: "2026-01-04"
draft: false
title: "College Attrition and the Dynamics of Information Revelation"
toc: true
math: true
weight:
categories:
    - 论文解析
tags:
    - 结构方程估计
---

这份文档专为经济学博士生设计，旨在从底层数学逻辑和计算实现角度解析论文《College Attrition and the Dynamics of Information Revelation》。

<!--more-->

# 技术手册：Arcidiacono et al. (2024) 动态学习模型的深度解构

## 1. 核心模型：多维能力的相关学习 (Correlated Learning)

该模型不同于简单的单维学习模型，其精髓在于能力向量的**跨部门相关性**。

### 1.1 能力的先验与分布

个体 $i$ 拥有五个维度的潜能力向量 $A_i = (A_{i2}, A_{i4S}, A_{i4N}, A_{iW}, A_{iB})'$。

-   **初始分布**：$A_i \sim N(0, \Delta)$。
-   **识别逻辑**：$\Delta$ 的非对角线元素识别了个体在不同部门间的**比较优势**。例如，$Cov(A_{i4S}, A_{iW})$ 为正则意味着理科学霸通常在白领市场也具备高生产力。

### 1.2 贝叶斯更新的矩阵表达

个体进入 $t$ 期时拥有先验均值 $E_{t-1}(A_i)$ 和协方差 $\Lambda_{t-1}$。 当个体在 $t$ 期选择 $d_{it}$（例如：读理科并兼职蓝领），他会收到两个信号 $\tilde{S}_{it}$：

1. **成绩信号**：$S_{i,4S,t} = G_{i,4S,t} - \gamma X$
2. **工资信号**：$S_{i,B,t} = w_{i,B,t} - \delta$

**更新方程 (Kalman Filter 形式)：** 定义 $\Omega_{it}$ 为一个 $5 \times 5$ 的精度矩阵，仅在选择对应的对角线上有值（值为 $1/\sigma^2$），其余为 0。

> 详见 《卡尔曼滤波法》

$$E_t(A_i) = \underbrace{(\Lambda_{t-1}^{-1} + \Omega_{it})^{-1}}_{\text{新协方差 } \Lambda_t} (\Lambda_{t-1}^{-1} E_{t-1}(A_i) + \Omega_{it} \tilde{S}_{it})$$

**博士生注意**：这里的 $\Lambda_t$ 是确定性演化的（只要路径确定），而 $E_t$ 是随机演化的。这使得我们在外层循环中可以预计算协方差矩阵。

## 2. 估计第一阶段：不可观测异质性的识别 (Types)

为了控制“初始偏好异质性”，作者假设存在 $R=8$ 种离散类型。

### 2.1 测量系统的似然函数

对于测量指标 $M_i$（如 ASVAB 分数），似然函数为：

$$L_{imr} = \prod_{k} \frac{1}{\sigma_k} \phi\left( \frac{M_{ik} - X_i \beta_{meas} - \omega_{kr}}{\sigma_k} \right)$$

其中 $\omega_{kr}$ 是类型 $r$ 的特定截距。通过最大化综合似然函数 $\sum_i \ln (\sum_r \pi_r L_{imr} \dots)$，我们得到：

-   **类型权重 (Posterior Type Probability)**：$q_{ir} = \frac{\pi_r L_{ir}}{\sum_{r'} \pi_{r'} L_{ir'}}$。
-   **复现关键**：在后续的所有估计步骤中，$q_{ir}$ 被视作个体的观测权重，用于所有的加权回归和 MLE。

## 3. 估计第二阶段：EM 算法与结果方程

如何从噪声极大的工资和成绩数据中识别出 5 维能力的 $\Delta$ 矩阵？

### 3.1 似然函数的分解

在 EM 算法的 **M-step** 中，我们最大化完整数据的对数似然：

$$Q(\Theta) = \sum_i \sum_r q_{ir} \int \ln f(G_i, w_i | A_i, r, \Theta) d \Phi(A_i | G_i, w_i, r, \Theta^{(n)})$$

由于假设信号噪声 $\epsilon$ 服从正态分布，这个积分有解析解。这使得我们可以把复杂的似然函数拆解为五个独立的回归问题（对应 5 个能力维度）。

### 3.2 识别逻辑 (Identification)

-   $\gamma, \xi$ **的识别**：利用跨个体的观测变量变化。
-   $\Delta$ **的识别**：利用残差的**序列协方差结构**。
    -   $Cov(Residual_{it}, Residual_{i,t+k})$ 识别了持久能力 $A_i$ 的方差。
    -   $Cov(Residual_{Grade}, Residual_{Wage})$ 识别了跨部门能力的相关性。

## 4. 估计第三阶段：有限依赖性 (Finite Dependence)

这是本文解决动态规划“维数灾难”的终极武器。

### 4.1 为什么要用 FD？

状态空间中的信念 $E_t(A_i)$ 是连续的。如果使用后向递归（Value Function Iteration），每一步都要进行 5 维积分，计算上是不可能的。

### 4.2 路径构造与权重消解

作者构造了两条路径，使其在 $t+2$ 期末达到相同的分布。 以比较“上学 (S)”与“在家 (H)”为例：

-   **路径 1**：$d_t = S$, $d_{t+1} = H$, $d_{t+2} = H$
-   **路径 2**：$d_t = H$, $d_{t+1} = S$, $d_{t+2} = H$

**关键难点：搜索摩擦 (Search Friction)** 由于白领 Offer 到达率 $\lambda < 1$，你不能保证在 $t+1$ 选白领。 **作者的黑科技 (Path Weighting)**： 在计算 $v_H$ 时，对“接受白领 Offer”的分支赋予权重 $1/\lambda$，对“不接受”的分支赋予权重 $0$。通过这种**重采样权重**，强行在数学上抵消掉 Offer 到达率对未来期望价值的影响 [见 Appendix F.1.2]。

### 4.3 最终的回归方程

$$v_{jkl,t} - v_{h,t} = u_{jkl,t} - u_{h,t} + \underbrace{\beta [ \text{未来两期的预期流效用差} + \text{未来两期的 Log CCP 差} ]}_{\text{已知 Offset}}$$

-   **复现逻辑**：先估计一个灵活的 CCP Logit 回归，计算出 Offset，然后把 Offset 塞进一个多项 Logit 回归中直接估出 $\alpha$。

## 5. 消费效用的不确定性积分处理

论文设定了 CRRA 效用函数 $u(C) = \frac{C^{1-\theta}}{1-\theta}$。 由于工资 $w$ 是随机的，预期效用 $E[u(C)]$ 需要积分：

$$E[u(C)] = \int \max(W, \underline{C})^{1-\theta} dF(W)$$

-   **计算技巧**：论文通过蒙特卡洛积分预计算了一个关于状态变量的多项式近似函数。在结构估计时，直接调用该近似函数，避免在每次迭代中重新进行数值积分。

# 小白也能懂

这部分将以**参数**为核心，详细回答：**我们要估什么？用什么数据估？为什么这么估？**

## 0. 全局概览：参数空间的四个“篮子”

论文没有尝试一次性估计所有参数（Full Information Maximum Likelihood），因为计算量太大。作者采用了一种**分步估计**策略。我们将所有参数分为四类：

| 篮子  | 参数类别       | 核心符号                      | 来源     | 估计方法              | 识别数据 (Data)         |
| ----- | -------------- | ----------------------------- | -------- | --------------------- | ----------------------- |
| **0** | **校准参数**   | $\beta, \theta, C$            | **设定** | -                     | 外部文献 / 假设         |
| **1** | **离散异质性** | $\pi_r, \omega_{kr}$          | **估计** | 混合模型 MLE          | 辅助测量指标 (ASVAB等)  |
| **2** | **学习与结果** | $\Delta, \sigma, \gamma, \xi$ | **估计** | **EM 算法**           | 成绩单、工资数据        |
| **3** | **客观预期**   | $\psi, \delta_\lambda, \phi$  | **估计** | 加权 Logit / AR1      | 毕业状态、就业状态转移  |
| **4** | **结构偏好**   | $\alpha, \text{Costs}$        | **估计** | **Finite Dependence** | 离散选择序列 ($d_{it}$) |

## 1. 篮子 0：校准参数 (Calibrated Parameters)

这些参数无法在模型内部单独识别，或者不是研究重点，因此直接固定。

- **参数列表**：
  - $\beta = 0.95$：折现因子。
  - $\theta = 0.4$：CRRA 效用函数的风险厌恶系数。
  - $\underline{C} = \$2,800$：消费底线（Social Safety Net）。
- **来源**：参考现有文献（如 Keane and Wolpin, 2001）或根据数据特征设定。

## 2. 篮子 1：不可观测异质性参数 (Unobserved Types)

**目标**：解决“初始禀赋”问题。如果不控制这些，模型会错误地将个体的固定差异（如天生爱学习）归结为学习过程。

### 2.1 要估计哪些参数？

- **类型分布** $\pi_r$：8 种类型（$2 \times 2 \times 2$）在人口中的占比。
- **测量截距** $\omega_{kr}$：每种类型 $r$ 在测量指标 $k$ 上的表现均值。

### 2.2 用什么数据？怎么估计？

- **数据**：NLSY97 中的辅助测量指标 $M_{ik}$，包括 ASVAB 分数（认知能力）、高中迟到次数（非认知偏好）、父母问卷（动机）。
- **方法**：**混合模型极大似然估计 (Mixture Model MLE)**。
- **识别逻辑**：利用测量指标间的**协方差结构**。
  - 假设：给定类型 $r$，指标之间是独立的。
  - 如果某人在 ASVAB 和 SAT 上得分都高，且迟到次数少，这种跨指标的相关性只能由潜在类型 $r$ 解释。

### 2.3 为什么不需要结构估计？

这些参数描述的是“静态属性”，不涉及前瞻性决策（Forward-looking decision）。因此可以直接用静态的混合模型估计。

- **产出**：**后验概率权重** $q_{ir}$。这是连接后续所有步骤的关键桥梁。

## 3. 篮子 2：学习与结果参数 (Learning & Outcome Parameters)

这是模型的技术核心，处理连续潜变量 $A_i$。

### 3.1 要估计哪些参数？

1. **能力分布** $\Delta$ ($5 \times 5$ 协方差矩阵)：描述 5 种能力（2年制、4年制理科、非理科、白领、蓝领）的联合分布。
2. **信号噪声** $\sigma^2_{j\tau}, \sigma^2_l$：成绩和工资方程中的残差方差。
3. **生产函数** $\gamma, \xi$：能力 $A_i$ 转化为成绩 $G$ 和工资 $w$ 的系数。

### 3.2 为什么需要特殊的估计方法？

- **难题**：==能力 $A_i$ 是不可观测的，且个体在不断更新对 $A_i$ 的信念。我们无法直接观测 $A_i$，也就无法直接回归。==
- **方法**：**EM 算法 (Expectation-Maximization)**。

### 3.3 估计细节与公式

**E-step (期望步)**： 利用个体所有历史数据 $(G_i, w_i)$，计算能力的后验分布 $f(A_i | G_i, w_i)$。

$$E[A_i] = (\Delta^{-1} + \sum \Omega_{it})^{-1} (\sum \Omega_{it} \tilde{S}_{it})$$

**M-step (最大化步)**： 一旦我们有了 $A_i$ 的期望值，工资和成绩方程就**解耦**了。我们可以分别最大化各方程的似然函数：

$$\max_{\gamma, \sigma} \sum_i \sum_r q_{ir} \ln \phi\left( \frac{G_{ijt} - X \gamma - E[A_{ij}]}{\sigma} \right)$$

### 3.4 识别逻辑 (Identification)

- $\Delta$ **的识别**：依赖于残差的**持久性 (Persistence)** 和 **跨部门相关性**。
  - 如果你大一理科成绩好，大二理科成绩也好 $\to$ 识别出 $Var(A_{i4S})$ 大。
  - 如果你理科成绩好，毕业后白领工资高 $\to$ 识别出 $Cov(A_{i4S}, A_{iW}) > 0$。
- $\sigma^2$ **的识别**：依赖于残差的**瞬时波动**。

## 4. 篮子 3：客观预期参数 (Expectations)

在进入偏好估计前，必须先确定个体面临的客观环境约束。

### 4.1 要估计哪些参数？

- **毕业概率** $\psi$：Logit 参数（给定学分和能力，下期能毕业吗？）。
- **白领 Offer 到达率** $\delta_\lambda$：Logit 参数（给定学历，下期能拿到 Offer 吗？）。
- **宏观冲击** $\phi$：AR(1) 参数（宏观经济波动）。

### 4.2 估计逻辑

- **数据**：NLSY97 面板中的状态转移（如：大三 $\to$ 毕业；蓝领 $\to$ 白领）。
- **方法**：**加权 MLE (Weighted MLE)**。权重为 $q_{ir}$。
- **假设**：理性预期 (Rational Expectations)。假设个体主观感知的概率等于数据中客观统计出来的概率。

## 5. 篮子 4：结构偏好参数 (Structural Utility Parameters)

这是回答“为什么退学”的终极一步。

### 5.1 要估计哪些参数？

- **流效用系数** $\alpha$：常数项、父母收入对上学的效用影响、非金钱回报。
- **转换成本 (Switching Costs)**：保持现状的惯性（如 $1(d_{t-1}=\text{School})$ 的系数）。

### 5.2 为什么要进行结构估计？

如果我们直接跑一个 Logit 回归 $P(d_{it}) = f(X_{it})$，得到的系数混杂了**当前偏好**和**未来预期**。

- 例子：一个学生即使觉得上学很痛苦（当前效用低），也可能因为预期未来工资高而坚持上学（未来期权价值高）。
- **结构估计的目的**：把“当前痛苦” ($\alpha$) 和“未来预期” ($\beta E[V]$) 剥离出来。

### 5.3 估计方法：有限依赖性 (Finite Dependence) + CCP

为了避免求解贝尔曼方程（DP），作者使用了 FD 技术。

**核心公式推导**： 我们要估计 $v_{jkl} - v_h$（选择 $j$ 与选择在家的价值差）。

$$\ln \frac{P_{jkl}}{P_h} = \underbrace{u_{jkl} - u_h}_{\text{含待估参数 } \alpha} + \beta \underbrace{\left( E_t[V_{t+1} | j] - E_t[V_{t+1} | h] \right)}_{\text{未来价值差}}$$

**FD 的魔法**： 通过构造两条路径（路径 A：先上学再回家；路径 B：先回家再上学再回家），使得在 $t+3$ 期状态重合。 这使得“未来价值差”可以被表示为**观测到的选择概率 (CCPs)** 和 **预期流效用** 的函数：

$$E_t[V_{t+1} | j] - E_t[V_{t+1} | h] = \text{Function of } (\text{Future CCPs}, \text{Future Wages}, \text{Offer Probs})$$

这一项被称为 **Offset**。

### 5.4 最终回归

将 Offset 移到方程左边：

$$\ln \frac{P_{jkl}}{P_h} - \text{Offset} = (X_{jkl} - X_h) \alpha$$

这变成了一个标准的、带有 Offset 项的多项 Logit 回归。

- **数据**：离散选择序列 $d_{it}$。
- **估计**：直接最大化这个 Logit 的似然函数即可得到 $\alpha$。

## 6. 总结：参数与数据的映射全图

| 步骤  | 任务       | 输入数据               | 输出参数                         | 核心技术          |
| ----- | ---------- | ---------------------- | -------------------------------- | ----------------- |
| **1** | **定类型** | 辅助测量指标 (ASVAB等) | 类型概率 $q_{ir}$                | Mixture Model     |
| **2** | **定能力** | 成绩单、工资流水       | 能力分布 $\Delta$, 噪声 $\sigma$ | EM Algorithm      |
| **3** | **定环境** | 毕业/就业状态转移      | 转移概率 $\psi, \delta_\lambda$  | Weighted Logit    |
| **4** | **定偏好** | 也是选择序列 $d_{it}$  | 效用系数 $\alpha$                | Finite Dependence |

**复现提示**： 你在复现时，不需要写一个巨大的 Nested Fixed Point (NFXP) 循环。 你只需要写**四个独立的脚本**，分别对应上述四步。前一步的输出（如 $q_{ir}$ 或 $\Delta$）作为后一步的输入（已知常数）。这就是这篇论文在计算上如此优雅的原因。

## 6. 复现建议与 Checklist

1. **数据构建**：
    - [ ] 提取 NLSY97 的大学成绩单（Transcript）。
    - [ ] 定义白领/蓝领职业（基于学历占比）。
2. **第一步 (Types)**：
    - [ ] 跑一个 Mixture Model (如使用 R 的 `flexmix` 或 Python 的 `scikit-learn` 混合模型工具)。
3. **第二步 (Learning)**：
    - [ ] 编写 EM 循环。注意协方差矩阵 $\Delta$ 必须保持正定（Positive Definite）。
4. **第三步 (CCPs)**：
    - [ ] 跑一个包含高阶项的 Multinomial Logit，作为 CCP 的初值。
5. **第四步 (Structural)**：
    - [ ] 计算基于 Appendix F 的 Offset 项。注意处理白领 Offer 的权重。
    - [ ] 运行结构 Logit 估计 $\alpha$。

**核心总结**：该论文的伟大之处在于其**“分步解决策略”**。它将一个看似不可解的、带有连续信念状态的高维动态规划问题，拆解成了可以用简单加权回归解决的模块。这正是经济学博士生应该学习的高级实证建模技巧。
